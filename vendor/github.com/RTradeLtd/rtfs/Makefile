all: build

.PHONY: deps
deps:
	go get -u github.com/vburenin/ifacemaker
	dep ensure
	git submodule update --init

.PHONY: build
build: deps
	go build ./...

.PHONY: testenv
testenv:
	( cd testenv ; make testenv )

.PHONY: test
test: vendor
	go test -race -cover ./...

.PHONY: lint
lint: vendor
	golint $(go list ./... | grep -v /vendor/)

.PHONY: clean
clean:
	( cd testenv ; make clean )

.PHONY: check
check:
	go vet ./...
	go test -run xxxx ./...

.PHONY: gen
gen:
	ifacemaker \
		-f rtfs.go \
		-s IpfsManager \
		-i Manager \
		--pkg rtfs \
		-o ./rtfs.i.go \
		-c "Code generated by ifacemaker. DO NOT EDIT." \
		-y "Manager provides functions for interacting with IPFS"
